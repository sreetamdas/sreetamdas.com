@import "tailwindcss";

@font-face {
	font-family: "Iosevka";
	src: url("/fonts/iosevka/iosevka-das-version-regular.subset.woff2") format("woff2");
	font-weight: normal;
	font-style: normal;
	font-display: swap;
}
@font-face {
	font-family: "Iosevka";
	src: url("/fonts/iosevka/iosevka-das-version-italic.subset.woff2") format("woff2");
	font-weight: normal;
	font-style: italic;
	font-display: swap;
}
@font-face {
	font-family: "Iosevka";
	src: url("/fonts/iosevka/iosevka-das-version-bold.subset.woff2") format("woff2");
	font-weight: 700;
	font-style: normal;
	font-display: swap;
}
@font-face {
	font-family: "Iosevka";
	src: url("/fonts/iosevka/iosevka-das-version-bold-italic.subset.woff2") format("woff2");
	font-weight: 700;
	font-style: italic;
	font-display: swap;
}

@theme {
	--light-purple: rgb(91 52 218);
	--light-blue: rgb(53 142 241);
	--dark-purple: rgb(157 134 233);
	--dark-blue: rgb(97 218 251);
	--not-white: rgb(247 241 255);
	--karma-background: rgb(10 14 20);
	--black: rgb(0 0 0);

	--color-primary: var(--light-purple);
	--color-secondary: var(--light-blue);
	--color-foreground: var(--black);
	--color-background: var(--not-white);
	--color-karma-background: var(--karma-background);

	--font-serif: "Bricolage Grotesque Variable", serif;
	--font-mono: "Iosevka", serif;

	--max-width: 650px;
	--radius-global: 5px;
	--transition-duration: 250ms;
}

[data-color-scheme="dark"] {
	--color-primary: var(--dark-purple);
	--color-secondary: var(--dark-blue);
	--color-foreground: var(--not-white);
	--color-background: var(--black);
}

@custom-variant dark {
	&:where([data-color-scheme="dark"], [data-color-scheme="dark"] *) {
		--color-primary: var(--dark-purple);
		--color-secondary: var(--dark-blue);
		--color-foreground: var(--not-white);
		--color-background: var(--black);
	}
}

@media print {
	@page {
		margin: 0;
	}

	/* Use light mode when printing */
	[data-color-scheme="dark"] {
		--color-primary: var(--light-purple);
		--color-secondary: var(--light-blue);
		--color-foreground: var(--black);
		--color-background: var(--not-white);
	}
}

@utility gradient {
	@apply from-primary to-secondary bg-gradient-to-r box-decoration-slice bg-clip-text text-transparent;
}

@utility font-code {
	font-family: var(--font-iosevka);
}

@utility link-base {
	color: var(--color-primary);
	background-image: linear-gradient(90deg, var(--color-secondary) 0%, var(--color-secondary) 100%);
	background-size: 0 2px;
	background-position: 100% 100%;
	background-repeat: no-repeat;
	transition: background-size var(--transition-duration) ease-in-out;

	&:hover {
		background-size: 100% 2px;
		background-position: 0 100%;
	}

	&:focus-visible {
		outline: 2px dashed var(--color-secondary);
		outline-offset: 2px;
	}

	&:has(svg:first-child:last-child) {
		background: none;
	}

	@media (prefers-color-scheme: dark) {
		& > code {
			color: var(--color-secondary);
		}
	}
}

strong > em {
	/* color: theme(colors.primary); */
	color: var(--color-primary);
}

/* Shiki code block: line numbers via CSS counters and highlight styling */
pre.shiki-code-block > code {
	counter-reset: line;
}

pre.shiki-code-block > code > .line {
	display: block;
}

pre.shiki-line-numbers > code > .line::before {
	counter-increment: line;
	content: counter(line);
	display: inline-block;
	width: 0;
	text-align: right;
	color: rgb(113 113 122); /* zinc-600 */
	user-select: none;

	@media (min-width: 640px) {
		width: 2rem;
		margin-left: -0.5rem;
		margin-right: 0.5rem;
		padding-right: 0.5rem;
	}

	@media (max-width: 639px) {
		opacity: 0;
	}
}

pre.shiki-code-block > code > .line[data-highlight="true"] {
	margin-left: -1.25rem;
	margin-right: -1.25rem;
	padding-left: 1rem;
	padding-right: 1.25rem;
	border-left: 4px solid #a86efd;
	background-color: #d0b2ff1a;
}

pre.shiki-code-block > code > .line[data-highlight="true"]::before {
	color: #a86efd;
}

@media (max-width: 639px) {
	pre.shiki-code-block > code > .line {
		white-space: pre-wrap;
	}
}
